#!/bin/bash

set -e

HOSTNAME=$1
FILENAME=$2

if [ -f ${FILENAME} ]; then
  PRIVATE_KEY=$(cat ${FILENAME} | base64)
  export GIT_SSH_KEY_GITLAB="${PRIVATE_KEY}"
  export GIT_SSH_HOST_GITLAB=${HOSTNAME}
fi

npm install -g git-ssh-key
git-ssh-key setup
ssh-keyscan ${HOSTNAME} >> ~/.ssh/known_hosts
